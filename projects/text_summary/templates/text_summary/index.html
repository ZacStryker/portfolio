{% extends "base.html" %}

{% block title %}Text Summarization - Zac Stryker{% endblock %}

{% block head_extra %}<style>.back-link:hover { color: #8b5cf6; }</style>{% endblock %}

{% block content %}
<div class="page-text-summary">
<div id="app-data" data-api-url="{{ url_for('text_summary.summarize') }}"></div>

<div class="project-header">
    <a class="back-link" href="{{ url_for('projects') }}">&#8592; Projects</a>
    <h1>Text Summarization</h1>
    <p class="subtitle">Transform long texts into concise summaries using advanced AI algorithms</p>
</div>

<div class="main-card">
    <div id="errorMessage" class="error-banner"></div>

    <div class="controls-panel">
        <div class="control-row">
            <div class="control-group">
                <label for="method">Summarization Method</label>
                <select id="method" onchange="updateControls()">
                    <option value="textrank">TextRank (Recommended)</option>
                    <option value="lsa">LSA (Latent Semantic Analysis)</option>
                    <option value="luhn">Luhn's Algorithm</option>
                    <option value="abstractive">Abstractive (BART - Neural)</option>
                </select>
            </div>

            <div id="extractiveControls" class="control-group">
                <label for="numSentences">Number of Sentences</label>
                <input type="number" id="numSentences" min="1" max="10" value="3">
            </div>

            <div id="abstractiveControls" style="display: none;">
                <div class="control-row">
                    <div class="control-group">
                        <label for="maxLength">Max Length</label>
                        <input type="number" id="maxLength" min="50" max="300" value="130">
                    </div>
                    <div class="control-group">
                        <label for="minLength">Min Length</label>
                        <input type="number" id="minLength" min="20" max="100" value="30">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-areas">
        <div class="text-section">
            <h2>Input Text</h2>
            <textarea id="inputText" placeholder="Paste your article, document, or any text you want to summarize here..."></textarea>
            <div class="file-upload">
                <input type="file" id="fileInput" accept=".txt,.md">
                <label for="fileInput">Upload text file</label>
                <span id="fileName"></span>
            </div>
        </div>

        <div class="text-section">
            <h2>Summary</h2>
            <div class="summary-output" id="summaryOutput">Your summary will appear here...</div>
        </div>
    </div>

    <div id="loading" class="loading-indicator">
        <div class="spinner"></div>
        <p>Generating summary...</p>
    </div>

    <div class="button-group">
        <button class="btn-primary" onclick="summarize()">Generate Summary</button>
        <button class="btn-secondary" onclick="clearText()">Clear</button>
        <button class="btn-success" onclick="downloadSummary()" id="downloadBtn" disabled>Download Summary</button>
    </div>

    <div class="metrics" id="metrics">
        <div class="metric-card">
            <div class="metric-value" id="originalWords">0</div>
            <div class="metric-label">Original Words</div>
        </div>
        <div class="metric-card">
            <div class="metric-value" id="summaryWords">0</div>
            <div class="metric-label">Summary Words</div>
        </div>
        <div class="metric-card">
            <div class="metric-value" id="compression">0%</div>
            <div class="metric-label">Compression Ratio</div>
        </div>
        <div class="metric-card">
            <div class="metric-value" id="timeTaken">0s</div>
            <div class="metric-label">Time Taken</div>
        </div>
    </div>
</div>

<div class="overview-card">
    <h3>README.md</h3>
    <p>Transform long texts into concise summaries using four different AI algorithms -- both extractive and abstractive methods. Paste text or upload a file, pick a method, and compare results with compression metrics.</p>

    <h4>Summarization Methods</h4>
    <div class="overview-table-wrapper">
        <table>
            <thead><tr><th>Method</th><th>Type</th><th>How It Works</th></tr></thead>
            <tbody>
                <tr><td><strong>TextRank</strong></td><td>Extractive</td><td>Graph-based sentence ranking (similar to PageRank)</td></tr>
                <tr><td><strong>LSA</strong></td><td>Extractive</td><td>Latent Semantic Analysis via singular value decomposition</td></tr>
                <tr><td><strong>Luhn</strong></td><td>Extractive</td><td>Keyword frequency scoring</td></tr>
                <tr><td><strong>BART</strong></td><td>Abstractive</td><td><code>facebook/bart-large-cnn</code> generates new summary sentences using beam search</td></tr>
            </tbody>
        </table>
    </div>
    <p>Extractive methods select and return existing sentences from the source. The abstractive method generates entirely new text.</p>

    <h4>Metrics</h4>
    <ul>
        <li>Original and summary word counts</li>
        <li>Compression ratio (percentage reduction)</li>
        <li>Processing time</li>
    </ul>

    <h4>Tech Stack</h4>
    <ul>
        <li><strong>Flask</strong> -- API backend (<code>POST /api/summarize</code>)</li>
        <li><strong>Hugging Face Transformers</strong> -- BART model for abstractive summarization</li>
        <li><strong>Sumy</strong> -- LSA, TextRank, and Luhn extractive algorithms</li>
        <li><strong>NLTK</strong> -- sentence tokenization</li>
        <li><strong>PyTorch</strong> -- model inference runtime</li>
    </ul>

    <h4>API</h4>
    <div class="overview-table-wrapper">
        <table>
            <thead><tr><th>Method</th><th>Path</th><th>Description</th></tr></thead>
            <tbody>
                <tr><td>GET</td><td><code>/text-summary/</code></td><td>Main page</td></tr>
                <tr><td>POST</td><td><code>/text-summary/api/summarize</code></td><td>Summarize text</td></tr>
            </tbody>
        </table>
    </div>
</div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('text_summary.static', filename='script.js') }}"></script>
{% endblock %}
